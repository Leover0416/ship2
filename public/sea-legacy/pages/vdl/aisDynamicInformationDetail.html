html lang="en" xmlns="">
<head></head>
<style>
    .layui-layer-title {
        display: none;
    }

    .layui-layer-setwin .layui-layer-close1 {
        display: none;
    }
</style>
<div class="layui-card" style="width:1695px; height: 950px;margin-left:-12px; padding: 0px ;background-color: #9F9F9F;">
    <div class="layui-card-header" style="background-color: white ;margin-top:-10px;;">
        <h2 class="header-title" style="font-weight: bold; font-size: 30px ;margin-top: -20px;"><font color="#9F9F9F">船台GPS定位无效结果</font>
        </h2>
    </div>
    <div style=" margin-top: 20px ;margin-left: 10px;">
        <div style="width: 100% ; height: 30px;background-color: white;">
            <p style="font-weight: bold; font-size: 20px ;background-color: white;padding: 10px">船舶基本信息：</p>
        </div>
        <div class="layui-card-body  " style="margin-top: 20px;background-color: white; ">
            <table class=layui-table" lay-skin="line" style="font-size: 14px">
                <tr>
                    <td>MMSI：</td>
                    <td><input style='border: 0px;' id='dynamicShipMmsi' readonly/></td>
                    <td style="display: none">id：</td>
                    <td><input style='border: 0px; display: none' id='dynamicShipId' readonly/></td>
                </tr>
            </table>
        </div>
        <div style="width: 100% ; height: 30px;background-color: white;margin-top: 20px;">
            <p style="font-weight: bold; font-size: 20px ;background-color: white;padding: 10px">船舶异常信息：</p>
        </div>
        <div class="layui-card-body  " style="margin-top: 20px;background-color: white; ">
            <table class=layui-table" lay-skin="line" style="font-size: 14px">
                <tr>
                    <td>异常确定时间：</td>
                    <td><input style='border: 0px;' id='abnormalTime' readonly/></td>
                    <td>异常类型：</td>
                    <td><input style='border: 0px;' id='abnormalType' readonly/></td>
                    <td>异常信息：</td>
                    <td><input style='border: 0px; width: 400px' id='abnormalInfo' readonly/></td>
                </tr>
                <tr>
                    <td>异常说明：</td>
                    <td><input style='border: 0px;' id='abnormalExplain' readonly/></td>
                </tr>
            </table>
        </div>
        <div style="width: 100% ; height: 30px;background-color: white;margin-top: 20px;">
            <p style="font-weight: bold; font-size: 20px ;background-color: white;padding: 10px">报文信息：</p>
        </div>
        <div style="margin-top: 20px;width: 100% ; height: 30px;background-color: white;">
            <table class="layui-table" lay-skin="line">
                <colgroup>
                    <col width="150">
                    <col width="200">
                    <col>
                </colgroup>
                <tr>
                    <td>报文类型：</td>
                    <td><input style='border: 0px;' id='msgId' readonly/></td>
                    <td>转发指示符：</td>
                    <td><input style='border: 0px;' id='repeat' readonly/></td>
                    <td>MMSI：</td>
                    <td><input style='border: 0px;' id='mmsi' readonly/></td>
                    <td>导航状态：</td>
                    <td><input style='border: 0px;' id='navigationState' readonly/></td>
                    <td>转向率ROTAIS：</td>
                    <td><input style='border: 0px;' id='rotais' readonly/></td>
                </tr>
                <tr>
                    <td>位置准确度：</td>
                    <td><input style='border: 0px;' id='positionAccuracy' readonly/></td>
                    <td>经度：</td>
                    <td><input style='border: 0px;' id='longitude' readonly/></td>
                    <td>纬度：</td>
                    <td><input style='border: 0px;' id='latitude' readonly/></td>
                    <td>SOG：</td>
                    <td><input style='border: 0px;' id='sog' readonly/></td>
                    <td>COG：</td>
                    <td><input style='border: 0px;' id='cog' readonly/></td>
                </tr>
                <tr>
                    <td>实际航向：</td>
                    <td><input style='border: 0px;' id='actualHeading' readonly/></td>
                    <td>时戳：</td>
                    <td><input style='border: 0px;' id='timestamp' readonly/></td>
                    <td>RAIM标志：</td>
                    <td><input style='border: 0px;' id='raim' readonly/></td>
                    <td>特定操纵指示符：</td>
                    <td><input style='border: 0px;' id='specificManipulationIndicator' readonly/></td>
                    <td>备用：</td>
                    <td><input style='border: 0px;' id='spare' readonly/></td>
                </tr>
                <tr>
                    <td>通信状态（同步状态）：</td>
                    <td><input style='border: 0px;' id='synchState' readonly/></td>
                    <td>通信状态（时隙超时）：</td>
                    <td><input style='border: 0px;' id='overtime' readonly/></td>
                    <td>通信状态（子消息）：</td>
                    <td><input style='border: 0px;' id='subMessage' readonly/></td>
                </tr>
                <tr>
                    <td>原始报文：</td>
                    <td><input style='border: 0px;' id='originalMessage' readonly/></td>
                </tr>
            </table>
        </div>
        <div style="width: 100% ; height: 30px;background-color: white;margin-top:220px ; ">
            <p style="font-weight: bold; font-size: 20px ;background-color: white;padding: 10px">异常处理：</p>
        </div>
        <div class="layui-card-body  " style="margin-top: 20px;background-color: white; height: 150px; ">
            <label class="layui-form-label">处理结果：</label>
            <div class="layui-input-block" style="margin-top: 7px;">
                <input type="radio" name="dealResult" value="MISJUDGED" title="误判" lay-filter="dealResult"
                       checked/><span>误判</span>
                <input type="radio" name="dealResult" value="RECTIFIED" title="已整改"
                       lay-filter="dealResult"/><span>已整改</span>
                <input type="radio" name="dealResult" value="SPECIAL" title="其他特殊情况"
                       lay-filter="dealResult"/><span>其他特殊情况</span>
            </div>
            <div class="layui-form-item" style="margin-top: 10px;">
                <label class="layui-form-label">情况说明：</label>
                <div class="layui-input-block">
                    <input name="title" id="description" class="layui-input layui-form-danger" required="" type="text"
                           placeholder="请输入情况说明" autocomplete="off" lay-verify="required">
                </div>
            </div>
            <div style=" margin-top: 10px; margin-left: 50px;">
                <button class="layui-btn layui-btn-normal" style="float: left;" lay-filter="deal-submit" lay-submit>保存
                </button>
                <a class="layui-btn layui-btn-normal " onclick="window.location.href='\#!aisDynamicInformation'"
                   style="margin-left: 20px;" id="return" lay-event="return">
                    返回
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    layui.use(['form', 'table', 'util', 'common', 'admin', 'laydate', 'jquery', 'layer', 'table', 'layedit', 'upload', 'element', 'carousel'], function () {
        var form = layui.form;
        var table = layui.table;
        var config = layui.common;
        var layer = layui.layer;
        var admin = layui.admin;
        var $ = layui.jquery;
        carousel = layui.carousel;
        var table = layui.table;
        let aisDynamicDetail = admin.getTempData('aisDynamic');
        $('#dynamicShipMmsi').val(aisDynamicDetail.mmsi);
        $('#mmsi').val(aisDynamicDetail.mmsi);
        $('#dynamicShipId').val(aisDynamicDetail.id)
        $('#msgId').val(aisDynamicDetail.msgId + "号");
        $('#abnormalType').val(aisDynamicDetail.resultTypeString + "异常");
        $('#abnormalInfo').val(aisDynamicDetail.resultInfoName);
        // $('#description').val(aisDynamicDetail.errorContent);
        $('#abnormalExplain').val(aisDynamicDetail.errorContent);
        $('#abnormalTime').val(layui.util.toDateString(aisDynamicDetail.receiveTime, "yyyy-MM-dd HH:mm:ss"));
        $('#repeat').val(aisDynamicDetail.repeat);
        var navStatusName = "";
        if (aisDynamicDetail.navStatus == 0) {
            navStatusName = "发动机使用中";
        } else if (aisDynamicDetail.navStatus == 1) {
            navStatusName = "锚泊";
        } else if (aisDynamicDetail.navStatus == 2) {
            navStatusName = "未操纵";
        } else if (aisDynamicDetail.navStatus == 3) {
            navStatusName = "有限适航性";
        } else if (aisDynamicDetail.navStatus == 4) {
            navStatusName = "受船舶吃水限制";
        } else if (aisDynamicDetail.navStatus == 5) {
            navStatusName = "系泊";
        } else if (aisDynamicDetail.navStatus == 6) {
            navStatusName = "搁浅";
        } else if (aisDynamicDetail.navStatus == 7) {
            navStatusName = "从事捕捞";
        } else if (aisDynamicDetail.navStatus == 8) {
            navStatusName = "航行中";
        } else if (aisDynamicDetail.navStatus == 11) {
            navStatusName = "机动船尾推作业";
        } else if (aisDynamicDetail.navStatus == 12) {
            navStatusName = "机动船顶推或侧推作业";
        } else if (aisDynamicDetail.navStatus == 13) {
            navStatusName = "留做将来用";
        } else if (aisDynamicDetail.navStatus == 14) {
            navStatusName = "AIS-SART";
        } else if (aisDynamicDetail.navStatus == 14) {
            navStatusName = "未规定";
        }
        $('#navigationState').val(navStatusName);
        $('#rotais').val(aisDynamicDetail.rot);
        $('#positionAccuracy').val(aisDynamicDetail.posAcc);
        $('#longitude').val((aisDynamicDetail.longitude) / 600000);
        $('#latitude').val((aisDynamicDetail.latitude) / 600000);
        $('#sog').val(aisDynamicDetail.sog);
        $('#cog').val(aisDynamicDetail.cog);
        $('#actualHeading').val(aisDynamicDetail.trueHeading);
        $('#timestamp').val(aisDynamicDetail.utcSec);
        $('#raim').val(aisDynamicDetail.raim);
        $('#specificManipulationIndicator').val(aisDynamicDetail.specialManIndicator);
        $('#spare').val(aisDynamicDetail.spare);
        $('#synchState').val(aisDynamicDetail.syncState);
        $('#overtime').val(aisDynamicDetail.slotIncrement);
        // $('#subMessage').val(aisDynamicDetail.);
        $('#originalMessage').val(aisDynamicDetail.originalMesage);
        $("#return").click(function () {
            admin.closePopupCenter();
        })
        $("#return").click(function () {
            admin.closePopupCenter();
        })
        // 表单提交事件
        form.on('submit(deal-submit)', function () {
            var data = {
                id: $('#dynamicShipId').val(),
                errorStatus: $("input[name='dealResult']:checked").val(),
                errorContent: $('#description').val(),
            }
            admin.req('AISDynamicInfo-Api/errorDynamicInfo/saveDeal', JSON.stringify(data), function (data) {
                if (data.resp_code === 0) {
                    layer.msg(data.resp_msg, {icon: 1, time: config.msgTime});
                    $('#abnormalExplain').val($('#description').val());
                } else {
                    layer.msg(data.resp_msg, {icon: 2, time: config.msgTime});
                }
            }, "POST");
        });
    });
</script>
</html>